--- ../src-base/minecraft/net/minecraft/network/PacketBuffer.java
+++ ../src-work/minecraft/net/minecraft/network/PacketBuffer.java
@@ -287,7 +287,7 @@
             {
                 CompressedStreamTools.write(nbt, new ByteBufOutputStream(this));
             }
-            catch (IOException ioexception)
+            catch (Exception ioexception) // CraftBukkit - IOException -> Exception TODO it cannot throw any other than IOException, or am I wrong?
             {
                 throw new EncoderException(ioexception);
             }
@@ -359,6 +359,7 @@
             int k = this.readShort();
             ItemStack itemstack = new ItemStack(Item.getItemById(i), j, k);
             itemstack.getItem().readNBTShareTag(itemstack, this.readCompoundTag());
+            if (itemstack.getTagCompound() != null) org.bukkit.craftbukkit.inventory.CraftItemStack.setItemMeta(itemstack, org.bukkit.craftbukkit.inventory.CraftItemStack.getItemMeta(itemstack)); //Craftbukkit - ??? TODO what is this
             return itemstack;
         }
     }
